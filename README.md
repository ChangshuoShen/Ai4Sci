## Starting Point

### Antigen-Specific Antibody Design via Direct Energy-based Preference Optimization
基于能量偏好优化的抗原特异性抗体设计方法
* <a href="./papers/Antibody_DPO.pdf">查看PDF</a>
* <a href="https://arxiv.org/abs/2403.16576">链接</a>

#### 主要内容:
* 研究目标：
    * 抗体的重要性：
        * 抗体是免疫系统中重要的 Y 型蛋白，识别并中和特定病原体（抗原）。
        * 关键区域为`互补决定区`（CDRs），尤其是 CDR-H3，它对抗体的特异性和多样性贡献最大。
    * 现有问题：
        * 传统的抗体设计方法效率低、易陷入局部最优。
        * 当前基于DL的抗体设计方法主要集中于序列设计，忽略了结构。
        * 现有的评估指标（如 RMSD 和 AAR）存在争议，未能准确衡量抗体质量。
        * 由于高质量数据稀缺，现有方法生成的抗体难以实现低能量和高结合亲和力。
    * 研究动机：提出一种新的抗体设计方法，以优化抗体的序列和结构以达到特定偏好：合理性（低能量结构）和功能性（高结合亲和力）。
* 相关工作
    * 抗体设计：
        * 传统方法：基于采样或搜索大数据空间优化物理/化学能量，但效率低。
        * 深度学习方法：
            * 序列-结构联合设计：通过图网络、扩散模型等生成抗体的序列和结构。
            * 相关研究：Luo et al. 引入扩散模型生成抗原特异性抗体；其他方法如 MEAN 和 AbDiffuser 引入物理约束。
        * 本文的创新点：强调低能量和高结合亲和力的抗体设计。
    * 生成模型的对齐（Alignment of Generative Models）：
        * 现有生成模型（如文本生成和图像生成）的对齐方法包括 RLHF、DPO 等，旨在使模型满足用户偏好。
        * 本文区别：生成抗体的扩散模型初始性能不足，因此偏好优化主要帮助模型理解自然规律。
* 方法
    1. 预训练扩散模型
        * 任务定义：
            * 设计抗体的 CDR-H3 区域（贡献最大），条件为抗原及抗体其余部分的结构。
            * 生成任务建模为条件分布：P(R|P)，其中 R 为待生成的 CDR-H3，P 为抗原及抗体其他部分。
        * 扩散模型：
            * 包括正向扩散过程（逐步增加噪声）和反向生成过程（逐步去噪重构数据）。
            * 使用 SE(3)-等变神经网络建模，训练目标是最小化 KL 散度，优化序列、坐标和方向。

    2. 基于能量偏好的直接优化
        * 目标：
            * 优化抗体的合理性（低能量）和功能性（高结合亲和力）。
            * 定义能量偏好：通过生物物理能量衡量抗体结构和结合亲和力。
        * 优化方法：
            * 受到 RLHF 和 DPO 启发，引入基于能量的奖励函数 r(R)。
            * 在更细粒度的残基（Residue）水平上定义偏好和优化目标。
        * 通过对抗体的能量解构为残基能量，逐步优化抗体的能量和偏好。

    3. 能量分解与冲突缓解
    * 问题：不同类型的能量（如吸引和排斥）可能导致优化目标冲突。
    * 解决方案：
        * 将能量分解为多个类型（如吸引能、排斥能）。
        * 引入“梯度修正”（Gradient Surgery）技术，缓解不同优化目标间的冲突。
* 实验结果：
    * 数据集：在 RAbD 基准测试上评估模型性能。
    * 实验结果：
        * 能量优化：ABDPO 方法生成的抗体能量更接近自然抗体，展示了高质量抗体生成能力。
        * 结合亲和力：生成的抗体在结合亲和力方面优于现有方法。
        * 泛化能力：ABDPO 在多种优化偏好中表现出良好的适应性。
    * 对比方法：与传统方法和现有深度学习方法（如 MEAN、DiffAb、AbDiffuser）对比，ABDPO 展示sota。

* 结论
    * 提出了一种基于能量偏好的抗体设计方法 ABDPO。
    * 实验结果表明，ABDPO 能有效生成结构合理、功能性强的抗体，优于现有方法。
    * 方法创新：
        * 基于能量的残基级优化。
        * 能量分解与冲突缓解。


### Aligning Target-Aware Molecule Diffusion Models with Exact Energy Optimization
* <a href="./papers/aligning-target-aware-molecule-diffusion.pdf">查看PDF</a>
* <a href="https://arxiv.org/abs/2407.01648">链接</a>
* <a href="https://github.com/MinkaiXu/AliDiff">codes</a>

#### 主要内容
1. 研究问题
    * 解决基于结构的药物设计(SBDD)问题——生成能与特定蛋白质靶点结合的配体分子
    * 旨在改进现有模型，引导分子生成朝向更好的结合亲和力和结构特性方向发展
        * 现有模型侧重于学习化学分布，对模型生成的化学质量缺乏足够的可控性，无法生成具有目标偏好的高质量分子。
2. 主要贡献——ALIFF框架
    * 目标: 通过调整目标条件下的化学分布，偏向具有更`低结合能量`和更`高结构合理性`的分子区域。
    * 关键模块:
        * 奖励函数驱动的偏好优化:
            * 使用用户定义的奖励函数（如结合亲和力）来引导分子生成。
        * 精确能量偏好优化 (E2PO):
            * 克服传统偏好优化中过拟合问题。
            * 提出了正则化目标函数，保证分布对齐的精确性。
            * 提供了严格的理论分析和收敛分布的闭式解。
        * 扩散模型对齐:
            * 在目标蛋白条件下，通过联合优化`离散原子类型`和`连续3D坐标`的变分下界实现分布对齐。
* 实验结果
    * 数据集: CrossDocked2020（经过精炼和分离）。
    * 对比基线模型: 包括 liGAN、AR、Pocket2Mol、TargetDiff、DecompDiff 和 IPDiff 等。
    * 评估指标:
        * 结合亲和力: Vina Score、Vina Min 和 Vina Dock。
        * 分子属性: 药物相似性 (QED)、可合成性 (SA) 和分子多样性。
    * 结果总结:
        * 结合亲和力:
            * ALIDIFF 在主要指标上表现出色（如平均 Vina Score 达到 -7.07）。
            * 分子生成的高亲和性比例（73.4%）。
        * 分子属性:
            * 保持了较强的药物相似性和化学合理性。
        * 超越了基线模型，如 TargetDiff 和 IPDiff。
* 相关工作
    * SBDD 生成模型:
        * 传统方法使用 SMILES 表示或图表示生成分子，但缺乏3D蛋白-配体交互建模。
        * 最近的扩散模型通过逐步去噪生成分子，在3D空间中取得了显著进展。
    * 偏好优化:
        * 基于人类反馈的强化学习（RLHF）被广泛应用于文本和图像生成任务。
        * 首次将偏好优化应用于目标感知配体设计。
* 方法分析
    * 理论保证: 提出了优化目标的变分上界，并证明了收敛分布的精确对齐。
    * 模型设计: 将分子生成分为两部分（原子类型和坐标），并进行了细粒度偏好对齐。
*  创新点
    * 开发改进的E2PO算法
    * 提供收敛分布的闭式表达
    * 解决偏好优化中常见的过拟合问题
    * 结合了离散化学类型和3D坐标特征
*  结论
    * ALIDIFF 框架在结合亲和力和分子属性上实现了最先进的性能。
    * 提出的精确能量偏好优化 (E2PO) 为目标感知分子生成提供了新的解决思路，可推广到其他生成任务。


### Enhancing Protein Mutation Effect Prediction through a Retrieval-Augmented Framework
* <a href="./papers/Protein_Mutation_prediction_RAG.pdf">查看PDf</a>
* <a href="https://neurips.cc/virtual/2024/poster/95577">链接</a>

#### 主要内容
* 研究背景：
    * 蛋白质突变效应预测对分析蛋白质功能和理解遗传疾病至关重要，尤其是理解点突变如何改变蛋白质的局部生化微环境
    * 当前模型在从`蛋白质数据库`中提取`与突变相关的局部结构模体信息`方面表现不佳，影响了预测的准确性和鲁棒性。
        * 多序列比对（MSA）：提取序列保守性信息，但局限于全局序列或结构层面的相似性
        * 结构聚类：在蛋白质家族中进行域级结构对齐，但对局部信息提取有限
    * 局限性：现有方法对局部结构模体的突变相关信息提取不足，无法充分捕获局部协同进化模式的信息

    * 提出一种检索增强框架，利用已知蛋白质结构中的相似局部结构信息来改进突变效应预测。
* 方法：
    * 构建了一个基于`预训练蛋白质结构编码器`的局部结构模体嵌入向量数据库。
        * 使用ESM-IF（基于蛋白质骨架结构的嵌入模型）提取局部结构模体的512维嵌入向量
        * 使用GPU加速的k近邻检索（CUHNSW），从中高效提取相似局部结构模体。
        * 构建了一个包含所有蛋白质银行（PDB）局部模块的结构模体嵌入数据库
    * 检索机制：提出多结构模体对齐（MSMA）
        * 从嵌入向量中检索与目标突变相关的局部结构模块
        * 通过度量空间中的相似性，提取与给定骨架结构相似的局部模块
    * 模型设计：提出多结构模体不变点注意模型（MSM-IPA）
        * 将检索到的局部模块信息与原始模体结合，利用交叉注意机制提取相似性信息
        * 通过对结合自由能变化（∆∆G）的预测，评估蛋白质表面的突变效应
    * 模型训练
        * 预训练：PDB-REDO数据集上进行预先训练，学习局部骨架结构对中心氨基酸类型的影响
        * 微调
            * 蛋白质稳定性预测任务：使用cDNA120K进行训练
            * 蛋白质-蛋白质相互作用（PPI）表面突变预测任务中：使用SKEMPI数据集做交叉验证
* 实验结果：
    1. 蛋白质-蛋白质相互作用（PPI）表面突变效应预测
        * 提出MSM-Mut，超过baseline，尤其是在`结构相关性指标`上
    2. SARS-CoV-2抗体优化案例研究
        * 成功预测已知的5种有异突变，验证了模型在`抗体设计任务`中的作用
        * 利用检索，提升对关键突变（RH103M）的预测能力
    3. 蛋白质稳定性变化预测任务
        * S669数据集上SOTA
        * Novozymes酶稳定数据集上，对`新蛋白和预测结构`泛化能力出色

* 方法优势与贡献：
    * 检索增强框架的创新性：
        * 提出了从`局部模体层面`提取协同进化信息的新方法。
        * SMEDB数据库支持GPU加速的快速检索，极大提高了效率。
    * 模型性能：
        * MSM-Mut模型在`∆∆G预测任务`中表现出色，超越了基于序列、结构的主流方法。
    * 实际应用潜力：
        * 在`抗体优化`和`酶稳定性预测`中的成功应用表明，该方法具有广泛的生物工程应用前景。
* 相关工作与对比：
    * 突变效应预测：
        * 传统方法：基于物理模型、统计模型、深度学习模型。
        * MSM-Mut首次在单一突变预测任务中结合多结构信息。
    * 检索增强深度学习：
        * 在语言建模中已有成功应用（如检索增强的GPT）。
        * 本研究将检索机制引入`蛋白质结构预测`领域，开创性地结合局部模体信息。

* 总结：
    * 本研究提出了一种检索增强的蛋白质突变效应预测框架，通过SMEDB和MSM-IPA模型，显著提升了∆∆G预测的性能。
    * 方法不仅验证了局部结构模体的重要性，也为`蛋白质工程中的突变设计`提供了新的工具和思路。

* 创新：
    * 开发结构基序嵌入数据库(SMEDB)，包含了蛋白质数据库(PDB)中所有结构
    * 提出多重结构基序对齐(MSMA)方法来检索局部协同进化基序
    * 设计多结构基序不变点注意力(MSM-IPA)模型来预测蛋白质结构适应度


### Rag2Mol: Structure-based drug design based on Retrieval Augmented Generation
* <a href="./papers/Rag2M生成的分子在数据库中搜索相似的可购买分子
        * Rag2Mol-R: 从数据库中创建能够适配3D口袋的新分子
3. 研究结果：
    * Rag2Mol方法能持续产生具有更优结合亲和力和药物性的候选药物
    * Rag2Mol-R相比传统虚拟筛选模型提供了:
        * 更广泛的化学空间覆盖
        * 更精确的靶向能力
    * 两种工作流都成功识别出了针对具有挑战性靶点PTPN2的潜在抑制剂
4. 研究意义：
    * 提供了一个可扩展的框架，可以整合多种SBDD方法
#### 主要内容
* 背景问题：
    * 药物发现痛点：
        * SBDD 模型的合成可行性不足，生成分子往往超出可合成化学空间（缺乏合成可行性）。
        * 数据驱动方法受限于训练数据的质量和覆盖范围。
        * 下游验证过程繁琐，导致药物开发效率低下。
    * 现有方法的局限性：
        * `自回归模型`、`扩散方法`、`流模型`和`语言模型`等存在化学多样性或蛋白结构信息不足的问题。
        * 合成可行性和化学知识未充分融入模型。

* 方法：
    * Rag2Mol 模型框架：
        * 核心组件：
            * 增强分子生成器：基于自回归生成分子。
            * 双级检索器：包括`全局检索器`和`分子检索器`，用于从外部数据库中筛选与`目标蛋白口袋`相关的小分子。

        * 生成流程：
            在生成过程中，模型`结合蛋白口袋信息`与`检索的参考小分子`生成新分子。
            分子检索器通过`轻量化网络加速检索`，提升生成效率。
    * 模块设计：
        * 编码器：
            * 使用几何向量感知器（GVP）对`蛋白口袋`和`分子特征`进行编码，保留 3D 几何信息。
        * 消息传递：
            * 通过`交叉 KNN 图`将参考分子与生成片段对齐，流动交叉消息。
        * 预测器：
            * 预测`焦点原子`、`相对位置`、`元素类型`及`可能的键类型`。
        * 训练策略：
            * 使用`随机掩码`训练生成器；结合`教师强制策略`和参考`分子增强模型`学习能力。

    * 双工作流：
        * Rag2Mol-G：`基于预训练检索器`，直接生成符合合成可行性和药物性质的小分子。
        * Rag2Mol-R：`生成候选分子并在数据库中搜索类似分子`，通过分子聚类和参考分子搜索优化生成分子。

* 实验与结果：
    1. 疏水性与药物特性对比：
        * Rag2Mol 在`结合亲和力`（Affinity1 和 Affinity2）、`合成可行性`（SA）、`药物相似性`（Lipinski 规则）等指标上均表现最优。
        * 与对比模型（Pocket2Mol、FLAG 等）相比，Rag2Mol 在结合亲和力上`超越了天然配体`约 3 kcal/mol（约 125 倍活性）。
    2. 生成分子质量：
        * Rag2Mol 生成的分子具有`更高的有效性比例`（PB-Valid）和`更低的几何误差`（RMSD）。
        * 在环结构分布、键角和二面角一致性上表现优越，特别是在复杂子结构建模方面。

    3. 蛋白-小分子相互作用分析：
        * Rag2Mol 能`捕捉复杂的微观相互作用模式`，生成的分子能`与多个靶点`形成合理的结合位姿。
        * 与实验验证的活性配体相比，Rag2Mol 生成的分子保留了关键相互作用，并额外预测了物理合理的增强相互作用。

    4. 类似先导化合物的发现：
        * Rag2Mol-R 在`化学空间覆盖率`和`靶向能力`上优于其他虚拟筛选模型（如 ConPLex 和 DrugBAN）。
        * t-SNE 可视化结果显示 Rag2Mol-R 的候选分子分布于化学空间边界甚至超出范围，展示`更大的化学多样性`。

    5. 案例研究：PTPN2 靶点：
        * Rag2Mol 成功设计出用于 PTPN2 靶点的抑制剂，解决了传统方法难以攻克的“不可药性”问题。
        * 候选分子 G1 和 R1 的结合亲和力分别为 -13.8 和 -12.1，优于现有化合物 AC484 的 -11.2。

* 结论与贡献：
    * Rag2Mol 提供了一个高效、可扩展的 SBDD 框架，能够生成具有`高结合亲和力`和`合成可行性`的小分子。
    * 通过结合`检索增强生成`方法，Rag2Mol 超越了传统 SBDD 和虚拟筛选工具。
    * 其两种工作流（Rag2Mol-G 和 Rag2Mol-R）适用于不同场景，特别是在解决复杂靶点药物设计方面表现优异。


## RAG + Ai4Sci
RAG在药物发现的一些相关文章

### Retrieval-Augmented Language Model for Knowledge-aware Protein Encoding
用于知识感知蛋白质编码的检索增强语言模型
* <a href="https://openreview.net/forum?id=0MVWOHwHDb">ICLR链接</a>
* <a href="./papers/7571_Retrieval_Augmented_Langu.pdf">查看PDF</a>
#### 摘要提取
* 问题背景：蛋白质语言模型（PLM，如ESM、ProtineinBert、ProtBert将氨基酸视作token）在捕捉蛋白质序列中编码的生物功能方面存在困难，原因在于缺乏事实性知识（如基因描述）。现有方法使用`蛋白质知识图谱`（PKG，提供蛋白质与基因本体GO之间的生物学关系）作为辅助编码目标，但存在不足：
    * 隐式嵌入知识，难以适应知识更新。
    * 忽略PKG中的结构信息，如蛋白质之间的高阶连接
    * 预训练和微调阶段的知识建模不一致，导致知识灾难性遗忘问题。
* 核心方法Kara：
    * 目标：
        * 实现PKG与蛋白质语言模型的统一建模，解决知识注入和高效利用问题
    * 核心组件
        * 知识检索器
            * 能够预测新蛋白质的潜在基因描述，生成与PKG对齐的知识
            * 检索过程
                * 根据新蛋白质的氨基酸序列，生成查询嵌入
                * 遍历PKG中`关系-实体`组合，生成候选知识，使用TransE得分函数对候选知识排序
            * 训练策略
                * 使用边际损失(margin loss)优化有效知识和无效知识之间的得分差异
                * 引入跨模态匹配损失，统一文本和氨基酸模态的嵌入空间
        * 上下文虚拟token
            * 将蛋白质的知识和结构信息分别构造成`知识虚拟token`和`结构虚拟token`，与氨基酸序列拼接，实现逐token的多模态信息融合
        * 结构正则化
            * 融入PKG中蛋白质的高阶连接信息，将功能相似性纳入表示学习中
            * 在预训练阶段和微调阶段统一优化，避免知识灾难性遗忘
    * 预训练阶段
        * 采用知识引导的掩码建模(MLM)任务，逐层学习氨基酸与虚拟token的交互
        * 使用边际损失约束高阶连接蛋白质的表示相似性
    * 微调阶段
        * 使用知识检索对新蛋白质生成潜在知识，与PKG对齐
        * 保持虚拟token和结构正则化的使用，统一优化目标
* 实验与分析：
    * 实验设计：
        * 在6个代表性任务上评估Kara，包括氨基酸接触预测（短程、中程、长程）、蛋白质相互作用预测（PPI）、蛋白质同源性检测等。
    * 实验结果：
        * Kara的性能全面优于现有方法（如KeAP、ESM-2）。
        * 示例：在长程接触预测任务上，Kara比KeAP提升11.6%，在蛋白质同源性检测任务上提升10.3%。
    * 消融实验：
        * 验证`知识检索器`、`虚拟token`以及`结构正则化`的独立贡献。


### ProtEx: A Retrieval-Augmented Approach for Protein Function Prediction
ProtEx：一种用于蛋白质功能预测的检索增强方法
* <a href="https://openreview.net/forum?id=ZxZabvtLwV">ICLR链接</a>
* <a href="./papers/11043_ProtEx_A_Retrieval_Augme.pdf">查看PDF</a>

#### 主要内容
* 研究问题
    * 将蛋白质序列映射到其生物学功能是一个关键问题，具有广泛的生物学、医学和化学应用。
    * 挑战
        * 分布外泛化问题：标签或序列空间的泛化能力不足
        * 稀有类别与“暗物质”蛋白：很多蛋白质的序列与已知分类类别差距较大，传统方法难以处理
    * 研究目标
        * 准确性、鲁棒性和泛化能力

* 方法：提出了ProtEx，一种基于检索增强的蛋白质功能预测方法，利用数据库中的样例（exemplars）来提高准确性、鲁棒性，并支持对未见类别的泛化。
    * 检索增强策略
        * 使用BLAST检索与候选标签相关的正负样例
        * 将这些样例与查询序列一起输入模型进行预测
    * 模型架构
        * 使用Transformer结构(T5)，支持多序列条件化输入
        * 模型针对每个候选标签进行二分类预测
    * 训练策略
        * 预训练：及基于无标签的序列对，设计一个多序列预训练任务，同时预测掩码残基和序列相似性分数
        * 微调：在有标注的数据集中，结合探索到的样例进行训练
    * 推理过程
        1. 索引相似序列
        2. 提取候选标签
        3. 选择正负样例
        4. 结合查询序列、候选标签和样例输入模型
        5. 聚合预测结果
* 实验与分析
    * 任务与数据集
        * EC 编号、GO 术语、Pfam 家族预测任务。
        * 数据集包含随机和聚类划分（基于序列相似性），以及不同的测试设置（如时间分割、新类别等）。
    * 主要实验结果
        * EC 和 GO 预测：
            * ProtEx 在随机和聚类分割上均超越基线（如 BLAST 与 ProteInfer）。
            * 在稀有类别和低相似性序列上改进显著。
        * 特殊测试集（如 NEW-392 和 Price-149）：
            * ProtEx 在时间分割和实验验证的 EC 数据集上表现最好。
        * Pfam 预测：
            * 在 Pfam 数据集上，ProtEx 提升了对低序列相似性测试集的预测能力。

    * 消融实验
        * 移除样例输入后性能显著下降，表明样例条件化预测是 ProtEx 的核心优势。
        * 不同样例选择策略、超参数的影响均进行了详细分析。
* 结论
    * ProtEx 提供了一种有效的检索增强方法，特别适用于稀有类别和未见类别的蛋白质功能预测。
    * 核心贡献：
        * 提出结合正负样例的检索增强预测方法。
        * 设计了一种多序列比较的预训练任务。
        * 验证了方法在多种数据集和任务上的泛化能力和性能优势。

### Retrieval Augmented Diffusion Model for Structure-informed Antibody Design and Optimization
用于结构知情抗体设计和优化的检索增强扩散模型
* <a href="https://openreview.net/forum?id=a6U41REOa5">ICLR链接</a>
* <a href="./papers/5690_Retrieval_Augmented_Diffu.pdf">查看PDF</a>

#### 主要内容
* 背景与问题：
    * 抗体是免疫系统中的关键蛋白质，可特异性识别病原体的抗原分子。
    * 当前的抗体生成模型多从零开始设计，不考虑结构模板，容易导致模型优化困难以及产生不自然的序列。
    * 抗体设计的核心是优化`互补决定区（CDRs）`，尤其是其与抗原的结合能力。
    * 当前实验方法费时费力，需要动物免疫或筛选大型抗体库，难以高效开发目标导向的抗体。
    
    * 深度生成模型的主要问题包括：
        * 生成的序列未能充分利用结构约束。
        * 数据集规模有限，导致模型泛化能力不足。

* 相关工作
    * 抗体设计分为传统优化方法和机器学习方法。
        * 传统方法：基于`序列相似性`和`能量函数优化`（如 Rosetta）。
        * 机器学习方法：包括语言模型（如 ESM）和逆折叠模型（如 ProteinMPNN）。
        * 当前方法大多从头生成序列，缺乏明确的`结构约束`，导致功能性抗体设计面临挑战。
    * Diffusion Model 扩散生成模型：
        * 扩散模型擅长生成任务，具灵活性和可控性，已在文本生成、分子生成等领域取得成功。
    * RAG 检索增强生成模型：
        * 结合检索机制，可通过引入额外数据库，使生成模型更具多样性和现实性。
        * 本文首次将检索增强机制用于抗体设计。
* 方法（RADAb 框架）
    * 总体框架：
        * RADAb 包括结构检索模块与扩散生成模块。
        * 检索模块基于目标抗体的结构，提取相似的 CDR 片段（motifs）。
        * 扩散生成模块结合检索结果与抗体上下文信息，逐步优化抗体序列。
    * 结构检索：
        * 用 MASTER 工具在 PDB 数据库中检索与目标 CDR 匹配的片段，依据 RMSD（均方根偏差）排序。
        * 检索得到的片段包含结构与进化信息，有助于生成类似功能的抗体序列。
    * 模型架构：
        * 全局几何上下文分支：
            * 编码抗体与抗原的几何信息（如残基类型、原子坐标等）。
            * 利用进化信息编码器（如 ESM2）提取抗体序列的进化关系。
            * 通过结构感知网络生成全局条件概率分布。
        * 局部 CDR 聚焦分支：
            * 处理检索到的 CDR-like 片段，通过轴向注意力机制捕获局部相似性。
            * 结合检索片段的条件概率分布，生成最终的 CDR 序列。
    * 训练与推理：
        * 训练目标是最小化预测分布与真实分布的 KL 散度。
        * 推理时，通过扩散过程逐步去噪，生成符合结构和功能约束的抗体序列。

4. 实验
    * 实验设置：
        * 数据集：使用 SAbDab 数据库，并构建包含 CDR-like 片段的数据库。
        * 任务：抗体 CDR 逆折叠与优化。
        * 基线方法：包括 Grafting、ProteinMPNN、ESM-IF1、Diffab-fix 等。
    * 任务 1：抗体 CDR 逆折叠：
        * RADAb 在所有 CDR 区域的氨基酸恢复率（AAR）上均优于其他方法。
        * 与传统方法相比，RADAb 更能生成结构合理且功能相关的序列。
    * 任务 2：抗体优化：
        * 在功能优化任务中，RADAb 显著改善了 ∆∆G（自由能变化），生成的抗体序列更加稳定和功能性。
    * 消融实验：
        * 去掉检索模块或进化信息模块后，模型性能显著下降，验证了检索增强机制的重要性。

5. 结论
    * RADAb 提供了一种新颖的`检索增强扩散框架`，可结合结构和进化信息，高效设计抗体。
    * 性能超越了现有方法，为抗体设计提供了新的视角。
    * 未来方向：
        * 扩展检索数据库，涵盖更多功能片段。
        * 进一步优化扩散模型的条件生成能力。


### Retrieval Augmented Zero-Shot Enzyme Generation for Specified Substrate
针对特定底物的 Retrieval Augmented Zero-Shot 酶生成
* <a href="https://openreview.net/forum?id=T7lQGq73Lm">ICLR链接</a>
* <a href="./papers/674_Retrieval_Augmented_Zero_S.pdf">查看PDF</a>

#### 主要内容
* 问题背景：
    * 生成催化特定目标分子的酶对生物材料合成和化学生产至关重要。
    * 零样本（zero-shot）生成问题：
        * 目标分子没有已知的天然酶，导致缺乏训练数据。
        * 目标分子底物化学多样性较大，学习酶与底物的复杂交互关系具有挑战性。
        * 现有无条件生成模型不能满足指定底物需求，条件生成模型（如抗体生成）无法直接应用于酶生成任务。

* 方法：
    * 任务定义：
        * 目标是生成能够催化目标分子的小分子酶序列。
        * 数据结构：底物以SMILES表示，酶以氨基酸序列表示。
        * 模型输入：目标分子的SMILES字符串，选填的附加信息包括酶分类号（EC号）或已有酶的结构信息。
    * 检索增强生成方法：
        * 检索模块：
            * 构建底物-酶关系数据库。
            * 基于底物相似性检索功能相似的酶。
            * 使用Tanimoto相似性度量目标底物与数据库中底物的结构相似性。
        * 生成模块：
            * 使用对齐的多序列比对（MSA）作为输入，采用离散扩散模型逐步生成新酶。
            * 将目标底物的图结构编码后嵌入生成模型，指导生成过程。
        * 训练方法：
            * 构建`重建损失函数`（Lr），使生成的分布与训练数据一致。
            * 使用`指导损失函数`（Lg），通过预训练的催化能力判别器引导生成酶的催化能力。
* 数据集与任务设置
    * 数据集构建：
        * 从RHEA数据库中提取底物-酶对，形成训练、验证和测试集。
        * 数据划分遵循两条规则：`不同集的底物不重叠`；`不同集的酶序列相似性不超过30%`。
        * 提供严格的零样本（zero-shot）测试设置。
* 实验与结果
    * 实验目标：验证模型生成的酶在催化能力和功能性上的优越性。
    * 实验数据：
        * 数据集包含34,982个底物-酶对，分为训练（26,757对）、验证（4,279对）和测试集（3,946对）。
    * 评估指标：
        * 使用kcat（酶的催化效率）作为评价指标，通过预测模型评估生成酶的催化能力。
    * 对比方法：
        * 规则基方法：随机生成序列、变异序列、检索序列。
        * 无条件生成方法：ProtGPT2、ProGen2。
        * 条件生成方法：ZymCTRL、NOS。
        * 基于结构的方法：LigandMPNN。
    * 实验结果：
        * SENZ在多个任务上的生成酶均表现出较高的催化效率（kcat）。
        * 相较于基线方法，SENZ生成的酶在催化能力、折叠性和功能性上更优。
* 贡献
    * 提出了零样本底物指定酶生成的正式定义。
    * 提供了一个新数据集并设计了评估框架。
    * 提出了一种检索增强生成方法，通过结合检索模块和生成模块，实现了高效的酶生成。

* 总结
    * SENZ通过结合检索与生成方法，有效解决了零样本酶生成问题。
    * 实验结果表明，SENZ在催化能力和结构稳定性方面表现优异，为底物指定酶生成提供了新的解决方案。

### RAG-Diffusion
* <a href="https://arxiv.org/abs/2204.11824v1">Arxiv链接</a>
* <a href="./papers/2204.11824v1.pdf">查看PDF</a>
* <a href="https://github.com/CompVis/retrieval-augmented-diffusion-models">代码</a>

